# 特殊勤務手当管理アプリ 仕様マニュアル

部活動指導等の手当を入力・申請するためのWebアプリの操作説明です。

---

## 1. アプリの概要

### 1.1 できること

- **手当の入力**：日付を選び、業務内容・行き先・運転・宿泊の有無を入力する
- **月ごとの集計確認**：支給予定額・合宿日数・遠征日数が自動表示される
- **手当の申請**：月単位で「手当申請」を押して申請する
- **複数日の一括入力**：同じ内容で複数日分をまとめて入力できる

### 1.2 利用の流れ（概要）

1. ログイン → 2. 氏名登録（初回のみ） → 3. カレンダーで日付を選んで手当を入力 → 4. 月末などに「手当申請」で申請

---

## 2. ログイン

### 2.1 ログイン画面の開き方

アプリのURL（例：https://haguro-allowance-app.vercel.app）をブラウザで開きます。

**【画像の挿入】**  
**場所**：この見出し「2. ログイン」の直後  
**内容**：ログイン画面の全体スクリーンショット（メールアドレス・パスワード入力欄、「ログイン」ボタン、「パスワードを忘れた方」リンクが写っていること）  
**説明**：「図1：ログイン画面」などとキャプションを付けると分かりやすいです。

### 2.2 ログイン手順

1. **メールアドレス**と**パスワード**を入力する
2. **「ログイン」**ボタンをクリックする
3. ログインに成功すると、カレンダー画面（トップ画面）に移動する

### 2.3 パスワードを忘れた場合

- ログイン画面の「パスワードを忘れた方」をクリックする
- 案内に従い、登録メールアドレスに送られるリンクからパスワードを再設定する

### 2.4 新規登録の手順

初めて利用する方は、ログイン画面から新規登録を行います。

1. アプリのログイン画面（/login）を開く
2. 画面上部のタブで**「新規登録」**をクリックする
3. 次の項目を入力する
   - **姓**・**名**（帳票に表示される名前。例：姓「三田村」、名「和真」）
   - **メールアドレス**（ログイン時に使用。学校などで使うアドレスを推奨）
   - **パスワード**（6文字以上。忘れないようにメモしておいてください）
4. **「新規登録してログイン」**ボタンをクリックする
5. 登録が完了すると、そのままカレンダー画面（トップ）に移動します。メール確認は不要です。

※すでに同じメールアドレスで登録済みの場合は、同じ画面の「ログイン」タブからログインしてください。

---

## 3. トップ画面（カレンダー）の見方

ログイン後、最初に表示されるのが「トップ画面」です。

**【画像の挿入】**  
**場所**：この見出し「3. トップ画面（カレンダー）の見方」の直後  
**内容**：トップ画面の全体スクリーンショット。次の要素がすべて写っていること  
- 上部：月の切り替え（‹ 2026年1月 ›）、支給予定額（¥0など）、合宿・遠征日数、期限の表示  
- その右：手当申請ボタン、氏名、規約閲覧・お問い合わせ・ログアウト、「複数日まとめて入力」ボタン  
- 中央：月間カレンダー（日付と休日・勤務日の表示）  
- 下部：「○月の手当履歴」一覧  
**説明**：「図2：トップ画面（カレンダー）全体」など。

### 3.1 画面上部の要素

| 表示・ボタン | 説明 |
|-------------|------|
| ‹ ○年○月 › | 月の切り替え。‹で前月、›で次月。 |
| 支給予定額 ¥○○○ | 表示中の月の手当合計（自動計算） |
| 合宿：○日 / 遠征：○日 | その月の合宿・遠征の日数 |
| 期限：翌月10日 | 入力・編集できる期限（翌月10日まで） |
| 💰 手当申請 | その月の手当を「申請」するボタン（下書きのときだけ押せる） |
| 👤 氏名 | 氏名の登録・変更（初回は「氏名登録」と表示） |
| 規約閲覧 | 手当規約のページへ移動 |
| お問い合わせ | 問い合わせページへ移動 |
| ログアウト | ログアウトする |
| 📅 複数日まとめて入力 | 複数日をまとめて同じ内容で入力するモード（後述） |

### 3.2 カレンダー上の表示

- **日付**：クリック（タップ）すると、その日の手当入力画面が開く
- **休日**：紫色の「休日」などと表示される日（土日・祝日は自動で休日扱い）
- **勤務日**：A・B・Cなどのラベルが付く日（年間予定に基づく）
- **入力済みの日**：白背景で、金額と業務内容が表示される
- **今日**：青い枠で強調される

**【画像の挿入】**  
**場所**：「3.2 カレンダー上の表示」の直後  
**内容**：カレンダー部分の拡大スクリーンショット。休日・勤務日ラベル・入力済みの日・今日がそれぞれ分かる状態  
**説明**：「図3：カレンダーの日付表示の例」など。

### 3.3 手当履歴（画面下部）

- 表示中の月に入力した手当が、日付・業務内容・金額の一覧で表示される
- 各行のゴミ箱アイコンで、その日付の手当を削除できる（申請前・期限内のみ）

---

## 4. 手当の入力方法（1日分）

### 4.1 入力の流れ

1. トップ画面のカレンダーで**日付をクリック（タップ）**する
2. その日の**手当入力画面（モーダル）**が開く
3. **業務内容・行き先・運転・宿泊**を選び、**「この内容で保存する」**を押す

**【画像の挿入】**  
**場所**：「4.1 入力の流れ」の直後  
**内容**：日付をクリックして開いた「○月○日(○)の手当入力」モーダル全体。タイトル・休日/勤務日バッジ・「部活動 業務内容」のプルダウン・保存ボタンまで写っていること  
**説明**：「図4：手当入力画面（1日分）」など。

### 4.2 入力項目の説明

#### 部活動 業務内容（必須）

プルダウンから1つ選びます。**休日のみ選べるもの**と**勤務日・休日どちらでも選べるもの**があります。

| 選択肢 | 選べる日 | 備考 |
|--------|----------|------|
| なし（部活なし） | いつでも | 手当なしにするとき |
| A:休日部活(1日) | 休日のみ | 2,400円 |
| B:休日部活(半日) | 休日のみ | 1,700円 |
| C:指定大会（対外運動競技等引率） | いつでも | 大会名入力あり |
| D:指定外大会 | いつでも | |
| E:遠征（部活動指導） | いつでも | 運転・宿泊で金額変動 |
| F:校内合宿（宿泊を伴う指導） | いつでも | 宿泊で加算 |
| G:研修旅行等引率 | いつでも | |
| 災害業務 | いつでも | 内容のテキスト入力必須 |
| その他（手入力） | いつでも | 内容・金額を手入力 |

- 休日の日に「A」「B」が選べない場合は、その日が休日として判定されていない可能性があります（土日・祝日は自動で休日になります）

#### 行き先（区分）

業務内容によって表示されます。次のいずれかから選択します。

- 校内
- 管内（庄内・新庄最上）
- 県内（片道120km以上）
- 県外

#### 指定大会の場合

「C:指定大会」を選んだときは**大会名**を入力します。  
県内120km以上または県外で「運転あり」のときは、**目的地（運転先）**も入力します。

#### 運転あり・宿泊あり

- **運転あり**：車で移動する場合にチェック（一部の業務では表示されません）
- **宿泊あり**：宿泊を伴う場合にチェック  

チェックの有無で**支給予定額が自動計算**されます。

### 4.3 支給予定額と保存

- 入力内容に応じて**支給予定額**が自動で表示される
- 内容を確認し、**「この内容で保存する」**をクリックして保存する
- 保存後、モーダルが閉じ、カレンダーと手当履歴が更新される

**【画像の挿入】**  
**場所**：「4.3 支給予定額と保存」の直後  
**内容**：入力画面の下部。計算内訳・「支給予定額 ¥○○○」・「この内容で保存する」ボタンが写っている状態  
**説明**：「図5：支給予定額と保存ボタン」など。

### 4.4 編集・削除

- **編集**：同じ日付を再度クリックして入力画面を開き、内容を変えて保存する
- **削除**：トップ画面下部の「○月の手当履歴」で、該当行のゴミ箱アイコンをクリックして削除する  
※申請済み・期限過ぎの月は編集・削除できません。

---

## 5. 複数日まとめて入力

同じ内容で**複数の日**にまとめて手当を入れたいときに使います。

### 5.1 手順

1. トップ画面で**「📅 複数日まとめて入力」**ボタンをクリックする
2. カレンダー直上に**「📅 カレンダーから日付をタップで選択/解除」**などの案内バーが出る
3. **カレンダーで日付をクリック**するたびに、その日が選択／解除される（複数日選べる）
4. 選択した日付が案内バーに「○日選択中」「1/3」「1/5」のように表示される
5. **「✏️ 内容を入力」**をクリックする
6. 開いた入力画面で**業務内容・行き先・運転・宿泊**を入力し、**「この内容で保存する」**を押す
7. 選択した**すべての日**に同じ内容で保存される

**【画像の挿入】**  
**場所**：「5.1 手順」の直後  
**内容**：複数日選択モードの状態。カレンダー直上のコンパクトな案内バー（「○日選択中」や日付タグ、「内容を入力」「✕」ボタン）と、その下の通常サイズのカレンダーが両方写っていること  
**説明**：「図6：複数日選択モード（案内バーとカレンダー）」など。

### 5.2 注意点

- 選択した日の中に**申請済み・期限過ぎ**の日があると、「内容を入力」時に注意メッセージが出ます
- 選択モードをやめるときは、案内バーの**「✕」**をクリックする

---

## 6. 手当の申請

### 6.1 申請の意味

- その月の手当を「確定して申請する」操作です
- 申請すると、**承認されるまで手当の編集はできません**
- 申請後は画面で「💰 申請中」と表示されます

### 6.2 申請の手順

1. 申請したい月の手当を**すべて入力**する
2. トップ画面でその月を表示した状態で、**「💰 手当申請」**ボタンをクリックする
3. 確認ダイアログで件数・合計金額を確認し、**OK**で申請する
4. 「手当を申請しました」と表示されれば完了

**【画像の挿入】**  
**場所**：「6.2 申請の手順」の直後  
**内容**：「💰 手当申請」ボタンが表示されている状態のスクリーンショット（申請前）。可能なら、クリック後の確認ダイアログも1枚あるとよい  
**説明**：「図7：手当申請ボタンと確認画面」など。

### 6.3 申請後の状態

- **申請中**：承認待ち。手当の入力・編集・削除はできない
- **承認済**：「💰 承認済」と表示される。内容の変更は不可

---

## 7. その他の機能

### 7.1 氏名登録・変更

- 初回ログイン時や氏名未登録のときは、**氏名登録のモーダル**が表示されます
- トップ画面の**「👤 氏名」**（または「⚙️ 氏名登録」）をクリックすると、登録・変更画面を開けます
- **姓**と**名**を入力して保存すると、帳票などに使う表示名が登録されます

### 7.2 規約閲覧

- **「規約閲覧」**をクリックすると、手当に関する規約を確認できるページに移動します

### 7.3 お問い合わせ（問い合わせ方法）

システムの不具合や操作方法の質問などを、管理者に送信できます。

**開き方**
- ログインした状態で、トップ画面の**「お問い合わせ」**をクリックすると、お問い合わせページに移動します

**入力項目**
- **件名**（必須）…例：「手当の入力方法について」
- **メッセージ**（必須）…質問や報告内容を詳しく記入してください

送信者情報（氏名・メールアドレス）は、ログイン中のアカウントから自動で付きます。回答は登録されているメールアドレスに送られます。

**送信の流れ**
1. 件名とメッセージを入力する
2. **「📧 お問い合わせを送信」**ボタンをクリックする
3. 「お問い合わせを送信しました」と表示されれば完了。通常、1〜2営業日以内にメールで回答があります
4. 数秒後に自動でメイン画面に戻ります（または「メイン画面に戻る」をクリック）

💡 エラーメッセージが出る場合は、その内容も件名やメッセージに含めると対応しやすくなります。

### 7.4 事務担当者（管理者）向けページ

- 管理者用メールアドレスでログインしている場合、画面上部に**「事務担当者ページへ」**のリンクが表示されます
- クリックすると、承認・Excel出力・設定などの管理機能があるページに移動します  
（一般ユーザー向けマニュアルでは、詳細は「管理者マニュアル」に任せてよいです）

---

## 8. よくある質問・注意事項

### Q1. 休日なのに「A:休日部活(1日)」が選べない

- その日が**休日として判定されているか**を確認してください。土日・祝日は自動で休日になります
- 年間予定で「勤務日」になっている日は休日扱いになりません

### Q2. 保存すると「テーブルが見つかりません」と出る

- データベース（Supabase）に**allowances**などのテーブルがまだない可能性があります
- 管理者に連絡し、テーブル作成（CREATE_ALL_TABLES.sql の実行）を依頼してください

### Q3. 入力・編集できる期限はいつまで？

- **翌月10日**までです。それを過ぎた月は編集・削除できません
- 画面上の「期限：翌月10日」を目安にしてください

### Q4. 申請したあとで内容を直したい

- 申請後は本人では編集できません。**管理者に連絡**し、いったん差し戻し（または対応方法）の案内を受けてください

### Q5. 複数日まとめて入力で、一部の日だけ内容を変えたい

- まとめて入力したあと、**変更したい日だけ**カレンダーでその日をクリックし、1日分の入力画面で内容を修正して保存してください

---

## 9. 画像挿入一覧（まとめ）

マニュアル内で挿入を推奨する画像と場所の一覧です。

| 番号 | 挿入場所（見出し） | 画像の内容 |
|------|---------------------|------------|
| 図1 | 2. ログインの直後 | ログイン画面全体（メール・パスワード欄、ログインボタン） |
| 図2 | 3. トップ画面の直後 | トップ画面全体（月表示・支給予定額・ボタン類・カレンダー・手当履歴） |
| 図3 | 3.2 カレンダー上の表示の直後 | カレンダー部分の拡大（休日・勤務日・入力済み・今日の例） |
| 図4 | 4.1 入力の流れの直後 | 手当入力モーダル全体（1日分の入力画面） |
| 図5 | 4.3 支給予定額と保存の直後 | 入力画面の下部（計算内訳・支給予定額・保存ボタン） |
| 図6 | 5.1 手順の直後 | 複数日選択モード（案内バー＋カレンダー） |
| 図7 | 6.2 申請の手順の直後 | 手当申請ボタン、および確認ダイアログ（あれば） |

---

**以上が、特殊勤務手当管理アプリの仕様マニュアルです。**  
画像は上記のとおり挿入すると、誰が見ても操作を追いやすくなります。
